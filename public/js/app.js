function updateMapCenter(t,o){$(t).gmap3({map:{options:{center:[o[0],o[1]]}}})}var PUSHER={APP_KEY:"733ba73955b91f5801f7",OPTIONS:{encrypted:!0}},GMAP={coords:{lat:10.30739,lng:123.89728},zoom:12,minZoom:15,defaultMarker:location.origin+"/images/default-marker.png"};$(function(){$("#setup-household-map").gmap3({map:{options:{center:[GMAP.coords.lat,GMAP.coords.lng],zoom:GMAP.zoom,disableDefaultUI:!0}},marker:{latLng:[GMAP.coords.lat,GMAP.coords.lng],options:{draggable:!0,icon:GMAP.defaultMarker},events:{dragend:function(t,o,n){var a=$.map(t.position,function(t){return t});updateMapCenter(this,a),$('input[name="coordinates"]').val(a[0]+","+a[1])}}}}),$("#include-location-modal").on("show.bs.modal",function(){$("#create-task-map").gmap3({map:{options:{center:[GMAP.coords.lat,GMAP.coords.lng],zoom:GMAP.zoom,disableDefaultUI:!0}}})}).on("shown.bs.modal",function(t){var o=$(t.relatedTarget);$("#create-task-map").gmap3({trigger:"resize",map:{options:{center:[GMAP.coords.lat,GMAP.coords.lng]}},marker:{latLng:[GMAP.coords.lat,GMAP.coords.lng],options:{draggable:!0,icon:GMAP.defaultMarker},events:{dragend:function(t,n,a){var e=$.map(t.position,function(t){return t});updateMapCenter(this,e);var i=e[0]+","+e[1];o.parent().parent().find("input[name=coordinates]").val(i)}}}})}).on("hidden.bs.modal",function(){$("#create-task-map").gmap3("destroy")}),$('a[href="#tab-additional-details"]').on("shown.bs.tab",function(t){$("#create-task-map").gmap3({trigger:"resize",map:{options:{center:[GMAP.coords.lat,GMAP.coords.lng]}}})}),$("#household-side-info-map,.map-with-coords").gmap3({map:{options:{center:[GMAP.coords.lat,GMAP.coords.lng],zoom:GMAP.minZoom,disableDefaultUI:!0},callback:function(){var t=$(this).data("coordinates").split(",");$(this).gmap3({map:{options:{center:[t[0],t[1]]}},marker:{latLng:[t[0],t[1]],options:{icon:GMAP.defaultMarker}}})}}}),$("#update-household-map").gmap3({map:{options:{center:[GMAP.coords.lat,GMAP.coords.lng],zoom:GMAP.minZoom,disableDefaultUI:!0},callback:function(){var t=$(this).data("coordinates"),o=t?t.split(","):[GMAP.coords.lat,GMAP.coords.lng];$(this).gmap3({map:{options:{center:[o[0],o[1]]}},marker:{latLng:[o[0],o[1]],options:{draggable:!0,icon:GMAP.defaultMarker},events:{dragend:function(t,o,n){var a=$.map(t.position,function(t){return t});updateMapCenter(this,a),$('input[name="coordinates"]').val(a[0]+","+a[1])}}}})}}})}),$(function(){function t(t,o,n){return $.ajax({method:t,url:o,data:n})}function o(o){var n=o.find('input[name="_method"]').val()||"POST",a=o.prop("action");return t(n,a,o.serialize())}function n(o,n){var a=o.find('input[name="_method"]').val()||"POST",e=o.prop("action"),i=o.serialize()+n;return t(a,e,i)}function a(t){t[0].reset()}function e(t){t.find("div.form-group").removeClass("has-error"),t.find("p.help-block").html("")}function i(t,o){var n=$("input[name="+t+"], select[name="+t+"], textarea[name="+t+"]"),a=n.closest("div.form-group"),e=(n.closest("p.help-block"),"");$.isEmptyObject(o)||(a.addClass("has-error"),$.each(o,function(t,o){e+=o+"<br/>"}),n.parent().parent().find("p.help-block").html(e).fadeIn(300))}function r(t,o){e(t),$.each(o,function(t,o){i(t,o)})}function s(t,o){swal({title:o||"Success",text:t,type:"success",timer:1500})}function d(t,o){swal({title:o||"Success",text:t,type:"info",timer:1500})}function c(t,o){swal({title:o||"Error",text:t,type:"error"})}$("form[data-form-remote]").on("submit",function(t){t.preventDefault();var n=$(this),e=o(n),i=n.find('input[type="submit"]');i.prop("disabled",!0),e.done(function(t){void 0!=t.message&&s(t.message),a(n),setTimeout(function(){void 0!=t.redirectTo?window.location=t.redirectTo:location.reload()},1e3)}).fail(function(t){null==t.responseJSON.error?r(n,t.responseJSON):c(t.responseJSON.error)}).always(function(){i.prop("disabled",!1)})}),$("input[data-confirm], button[data-confirm]").on("click",function(t){t.preventDefault();var o=$(this),n=o.closest("form"),a=o.data("confirm")||"Are you sure?",e=o.data("confirm-yes")||"Yes, pls!";swal({title:"Are you sure?",text:a,type:"warning",showCancelButton:!0,confirmButtonColor:"#DD6B55",confirmButtonText:e,cancelButtonText:"No, cancel pls!",closeOnConfirm:!1},function(t){t&&n.submit()})});var l=function(){$(".select2-multi").select2()},p=function(t,o){if("undefined"!=typeof tmpl){var n=o.data("index")>0?o.data("index"):o.children().length+1;o.data("index",n+1);var a=tmpl(t,{index:n}),e=$(a).appendTo(o).hide().slideDown("fast");l(e,n),e.on("click",".btn-delete",function(t){e.slideUp("fast",function(){e.remove()})})}};$("[data-duplicate]").on("click",function(t){var o=$(this),n=o.data("duplicate"),a=$(o.data("target"));p(n,a)}),$("[data-duplicate]").each(function(){var t=$(this),o=t.data("duplicate"),n=$(t.data("target"));p(o,n)}),$("input.material-datetime").bootstrapMaterialDatePicker({format:"YYYY-MM-DD HH:mm",minDate:new Date}),$(".select2-multi").select2(),$(".notification:not(.seen)").on("click",function(o){var n=$(this),a=n.data("id"),e=n.data("recipient");t("PATCH","/notification/markseen",{id:a,to_userid:e}).done(function(){n.addClass("seen")})}),$("ul.notifications-list .notification:not(.seen)").on("click",function(){var o=$(this),n=o.find("a").prop("href"),a=o.data("recipient");t("PATCH","/notification/markseen",{link:n,to_userid:a}).done(function(){o.addClass("seen")})}),$("#form-task-confirm button[data-task-confirm]").on("click",function(){var o=$(this).data("task-confirm"),n=$("#form-task-confirm"),a=n.find('input[name="_method"]').val()||"POST",e=n.prop("action"),i=n.serialize()+"&confirm="+o;t(a,e,i).done(function(t){d(t.message,""),setTimeout(function(){void 0!=t.redirectTo?window.location=t.redirectTo:location.reload()},1500)})}),$("#view-task-image-modal").on("show.bs.modal",function(t){var o=$(t.relatedTarget).find("img").prop("src");$(this).find(".modal-body img").prop("src",o)}).on("hidden.bs.modal",function(){$(this).find(".modal-body img").prop("src","")}),$(".btn-update-task-status").on("click",function(){var t=$(this),o=t.data("status"),a=t.data("userid"),e=t.closest("form"),i=e.find(".loader"),r="&status="+o+"&from_userid="+a;i.show(),n(e,r).done(function(n){return e.parent().find(".current-status-content").text(n.status),$(".tooltip").hide(),"done"===o?void t.parent().remove():void t.remove()}).always(function(){i.hide()})}),$(".form-task-leave-note").on("submit",function(t){t.preventDefault();var n=$(this),e=o(n),i=n.find(".loader");i.show(),n.find(".help-block").text(""),n.find(".form-group").removeClass("has-error"),e.done(function(t){var o=$("#noteTpl").html(),e=Mustache.to_html(o,t.note);$("#list-tasknote").prepend(e),$("#no-notes-item").remove(),$("#list-tasknote li").length>=6&&$("#list-tasknote li:last").remove(),a(n)}).fail(function(t){var o=t.responseJSON.note[0];n.find(".help-block").text(o),n.find(".form-group").addClass("has-error")}).always(function(){i.hide()})}),$("[data-tooltip-validation]").tooltip({trigger:"manual"}).tooltip("show"),$("input.mobile_no").inputmask("mask",{mask:"(+63) 999-9999999"}),$("table.datatable").DataTable()}),$(function(){$("[data-tooltip-validation]").tooltip({trigger:"manual"}).tooltip("show"),$("input.mobile_no").inputmask("mask",{mask:"(+63) 999-9999999"})});