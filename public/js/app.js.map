{"version":3,"sources":["constants.js","map-functions.js","maps.js","common.js","scripts.js"],"names":[],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACvBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACRA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACzJA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AC1UA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"app.js","sourcesContent":["/**\r\n * Created by Wayne on 7/14/2015.\r\n * CONSTANTS\r\n */\r\n\r\nvar PUSHER = {\r\n    APP_KEY: '733ba73955b91f5801f7',\r\n    OPTIONS: {\r\n        encrypted: true\r\n    }\r\n};\r\n\r\n/* MAP CONSTANTS */\r\nvar GMAP = {\r\n    coords: {\r\n        lat: 10.30739,\r\n        lng: 123.89728\r\n    },\r\n    zoom: 12,\r\n    minZoom: 15,\r\n    defaultMarker: location.origin + '/images/default-marker.png'\r\n};\r\n\r\n","function updateMapCenter(map, newLatLng) {\r\n    $(map).gmap3({\r\n        map: {\r\n            options: {\r\n                center: [newLatLng[0], newLatLng[1]]\r\n            }\r\n        }\r\n    });\r\n}","$(function () {\r\n\r\n        /* Household Page */\r\n        $('#setup-household-map').gmap3({\r\n            map: {\r\n                options: {\r\n                    center: [GMAP.coords.lat, GMAP.coords.lng],\r\n                    zoom: GMAP.zoom,\r\n                    disableDefaultUI: true\r\n                }\r\n            },\r\n            marker: {\r\n                latLng: [GMAP.coords.lat, GMAP.coords.lng],\r\n                options: {\r\n                    draggable: true,\r\n                    icon: GMAP.defaultMarker\r\n                },\r\n                events: {\r\n                    dragend: function (marker, event, context) {\r\n                        var newLatLng = $.map(marker.position, function (el) {\r\n                            return el;\r\n                        });\r\n                        updateMapCenter(this, newLatLng);\r\n                        $('input[name=\"coordinates\"]').val(newLatLng[0] + ',' + newLatLng[1]);\r\n                    }\r\n                }\r\n            }\r\n        });\r\n\r\n\r\n\r\n    $('#include-location-modal')\r\n        .on('show.bs.modal', function(){\r\n            $('#create-task-map').gmap3({\r\n                map: {\r\n                    options: {\r\n                        center: [GMAP.coords.lat, GMAP.coords.lng],\r\n                        zoom: GMAP.zoom,\r\n                        disableDefaultUI: true\r\n                    }\r\n                }\r\n            });\r\n        }).on('shown.bs.modal', function(e){\r\n            var triggerBtn = $(e.relatedTarget);\r\n\r\n           $('#create-task-map').gmap3({\r\n               trigger: 'resize',\r\n               map: {\r\n                   options: {\r\n                       center: [GMAP.coords.lat, GMAP.coords.lng]\r\n                   }\r\n               },\r\n               marker: {\r\n                   latLng: [GMAP.coords.lat, GMAP.coords.lng],\r\n                   options: {\r\n                       draggable: true,\r\n                       icon: GMAP.defaultMarker\r\n                   },\r\n                   events: {\r\n                       dragend: function (marker, event, context) {\r\n                           var newLatLng = $.map(marker.position, function (el) {\r\n                               return el;\r\n                           });\r\n                           updateMapCenter(this, newLatLng);\r\n                           var latLng = newLatLng[0] + ',' + newLatLng[1];\r\n                           triggerBtn.parent().parent().find('input[name=coordinates]').val(latLng);\r\n                       }\r\n                   }\r\n               }\r\n           });\r\n        }).on('hidden.bs.modal', function(){\r\n            $('#create-task-map').gmap3('destroy');\r\n        });\r\n\r\n        $('a[href=\"#tab-additional-details\"]').on('shown.bs.tab', function (e) {\r\n            $('#create-task-map').gmap3({\r\n                trigger: 'resize',\r\n                map: {\r\n                    options: {\r\n                        center: [GMAP.coords.lat, GMAP.coords.lng]\r\n                    }\r\n                }\r\n            });\r\n\r\n        });\r\n\r\n        $('#household-side-info-map,.map-with-coords').gmap3({\r\n            map: {\r\n                options: {\r\n                    center: [GMAP.coords.lat, GMAP.coords.lng],\r\n                    zoom: GMAP.minZoom,\r\n                    disableDefaultUI: true\r\n                },\r\n                callback: function(){\r\n                    var latLngArray = ($(this).data('coordinates')).split(',');\r\n                    $(this).gmap3({\r\n                        map: {\r\n                            options: {\r\n                                center: [latLngArray[0], latLngArray[1]]\r\n                            }\r\n                        },\r\n                        marker: {\r\n                            latLng: [latLngArray[0], latLngArray[1]],\r\n                            options: {\r\n                                icon: GMAP.defaultMarker\r\n                            }\r\n                        }\r\n                    });\r\n                }\r\n            }\r\n        });\r\n\r\n        $('#update-household-map').gmap3({\r\n            map: {\r\n                options: {\r\n                    center: [GMAP.coords.lat, GMAP.coords.lng],\r\n                    zoom: GMAP.minZoom,\r\n                    disableDefaultUI: true\r\n                },\r\n                callback: function () {\r\n                    var coordinates = $(this).data('coordinates');\r\n                    var latLngArray = coordinates ? coordinates.split(',') : [GMAP.coords.lat, GMAP.coords.lng];\r\n\r\n                    $(this).gmap3({\r\n                        map: {\r\n                            options: {\r\n                                center: [latLngArray[0], latLngArray[1]]\r\n                            }\r\n                        },\r\n                        marker: {\r\n                            latLng: [latLngArray[0], latLngArray[1]],\r\n                            options: {\r\n                                draggable: true,\r\n                                icon: GMAP.defaultMarker\r\n                            },\r\n                            events: {\r\n                                dragend: function (marker, event, context) {\r\n                                    var newLatLng = $.map(marker.position, function (el) {\r\n                                        return el;\r\n                                    });\r\n                                    updateMapCenter(this, newLatLng);\r\n                                    $('input[name=\"coordinates\"]').val(newLatLng[0] + ',' + newLatLng[1]);\r\n                                }\r\n                            }\r\n                        }\r\n                    });\r\n                }\r\n            }\r\n        });\r\n\r\n        /* Household Page End */\r\n\r\n});\r\n","    $(function () {\r\n\r\n        /* Ajax Functions */\r\n\r\n        function processAjaxRequest(method, url, data) {\r\n            return $.ajax({\r\n                method: method,\r\n                url: url,\r\n                data: data\r\n            });\r\n        }\r\n\r\n        function processFormAjaxRequest(form) {\r\n            var method = form.find('input[name=\"_method\"]').val() || 'POST';\r\n            var url = form.prop('action');\r\n            return processAjaxRequest(method, url, form.serialize());\r\n        }\r\n\r\n        function processFormAjaxRequestWithData(form, additionalData) {\r\n            var method = form.find('input[name=\"_method\"]').val() || 'POST';\r\n            var url = form.prop('action');\r\n            var formData = form.serialize() + additionalData\r\n            return processAjaxRequest(method, url, formData);\r\n        }\r\n\r\n        /* End Ajax Functions */\r\n\r\n        /* Form Functions */\r\n\r\n        function resetForm(form) {\r\n            form[0].reset();\r\n        }\r\n\r\n        function clearForm(form) {\r\n            form.find('div.form-group').removeClass('has-error');\r\n            form.find('p.help-block').html('');\r\n        }\r\n\r\n        function displayError(fieldName, jsonObj) {\r\n            var current = $('input[name=' + fieldName + '], select[name=' + fieldName + '], textarea[name=' + fieldName + ']');\r\n\r\n            var currentFormGroup = current.closest('div.form-group'),\r\n                currentHelpBlock = current.closest('p.help-block'),\r\n                errorMessage = '';\r\n\r\n            if (!$.isEmptyObject(jsonObj)) {\r\n                currentFormGroup.addClass('has-error');\r\n                $.each(jsonObj, function (key, value) {\r\n                    errorMessage += value + '<br/>';\r\n                });\r\n                current.parent().parent().find('p.help-block').html(errorMessage).fadeIn(300);\r\n            }\r\n        }\r\n\r\n        function displayErrors(form, responseJSON) {\r\n            clearForm(form);\r\n\r\n            $.each(responseJSON, function (key, value) {\r\n                displayError(key, value);\r\n            });\r\n        }\r\n\r\n        /* Message Dialog */\r\n\r\n        function showSuccessMessage(message, title) {\r\n            swal({\r\n                title: title || \"Success\",\r\n                text: message,\r\n                type: \"success\",\r\n                timer: 1500\r\n            });\r\n        }\r\n\r\n        function showInfoMessage(message, title) {\r\n            swal({\r\n                title: title || \"Success\",\r\n                text: message,\r\n                type: \"info\",\r\n                timer: 1500\r\n            });\r\n        }\r\n\r\n        function showErrorMessage(message, title) {\r\n            swal({\r\n                title: title || 'Error',\r\n                text: message,\r\n                type: \"error\"\r\n            });\r\n        }\r\n        /* End Message Dialog */\r\n\r\n        /* Form Ajax Submission */\r\n        $('form[data-form-remote]').on('submit', function (e) {\r\n            e.preventDefault();\r\n\r\n            var form = $(this);\r\n            var deffered = processFormAjaxRequest(form);\r\n            var inputs = form.find('input[type=\"submit\"]');\r\n            inputs.prop('disabled', true);\r\n            deffered\r\n                .done(function (data) {\r\n\r\n                    if(data.message != undefined) {\r\n                        showSuccessMessage(data.message);\r\n                    }\r\n\r\n                    resetForm(form);\r\n\r\n                    setTimeout(function () {\r\n                        if(data.redirectTo != undefined){\r\n                            window.location = data.redirectTo;\r\n                        }else {\r\n                            location.reload();\r\n                        }\r\n                    }, 1000);\r\n                })\r\n                .fail(function (jqXHR) {\r\n                    if (jqXHR.responseJSON.error == null) {\r\n                        displayErrors(form, jqXHR.responseJSON);\r\n                    } else {\r\n                        showErrorMessage(jqXHR.responseJSON.error);\r\n                    }\r\n                })\r\n                .always(function () {\r\n                    inputs.prop('disabled', false);\r\n                });\r\n        });\r\n\r\n        /* Confirmation Dialog on Button Delete */\r\n        $('input[data-confirm], button[data-confirm]').on('click', function (e) {\r\n            e.preventDefault();\r\n\r\n            var input = $(this);\r\n            var form = input.closest('form');\r\n            var prompt = input.data('confirm') || 'Are you sure?';\r\n            var promptYes = input.data('confirm-yes') || 'Yes, pls!';\r\n\r\n            swal({\r\n                title: 'Are you sure?',\r\n                text: prompt,\r\n                type: 'warning',\r\n                showCancelButton: true,\r\n                confirmButtonColor: '#DD6B55',\r\n                confirmButtonText: promptYes,\r\n                cancelButtonText: 'No, cancel pls!',\r\n                closeOnConfirm: false\r\n            }, function (isConfirm) {\r\n                if (isConfirm) {\r\n                    form.submit();\r\n                }\r\n            });\r\n        });\r\n\r\n        var initMultiSelect2 = function () {\r\n            $('.select2-multi').select2();\r\n        };\r\n\r\n        var duplicateTemplate = function (templateId, target) {\r\n            if (typeof tmpl === 'undefined') {\r\n                return;\r\n            }\r\n            var o = this;\r\n\r\n            var index = (target.data('index') > 0) ? target.data('index') : target.children().length + 1;\r\n            target.data('index', index + 1);\r\n            var clonedContent = tmpl(templateId, {index: index});\r\n\r\n            // Add cloned source to parent\r\n            var newContent = $(clonedContent).appendTo(target).hide().slideDown('fast');\r\n\r\n            // Init date component\r\n            initMultiSelect2(newContent, index);\r\n\r\n            // Add delete event\r\n            newContent.on('click', '.btn-delete', function (e) {\r\n                newContent.slideUp('fast', function () {\r\n                    newContent.remove();\r\n                });\r\n            });\r\n        };\r\n\r\n        /* Jquery Microtemplating Duplication of Elements */\r\n        // Add event lsitener for duplication\r\n        $('[data-duplicate]').on('click', function (e) {\r\n            var item = $(this);\r\n            var templateId = item.data('duplicate');\r\n            var target = $(item.data('target'));\r\n            duplicateTemplate(templateId, target);\r\n        });\r\n\r\n        // Init dulicate function\r\n        $('[data-duplicate]').each(function () {\r\n            var item = $(this);\r\n            var templateId = item.data('duplicate');\r\n            var target = $(item.data('target'));\r\n            duplicateTemplate(templateId, target);\r\n        });\r\n        /* End Jquery Microtemplating Duplication of Elements */\r\n\r\n        $('input.material-datetime').bootstrapMaterialDatePicker({format: 'YYYY-MM-DD HH:mm', minDate: new Date()});\r\n\r\n        $('.select2-multi').select2();\r\n\r\n        /* Marking seen on Notifications */\r\n        $('.notification:not(.seen)').on('click', function(e){\r\n            var thisElement = $(this);\r\n            var id = thisElement.data('id');\r\n            var recipientId = thisElement.data('recipient');\r\n\r\n           processAjaxRequest('PATCH', '/notification/markseen', {id: id, to_userid: recipientId})\r\n               .done(function(){\r\n                   thisElement.addClass('seen');\r\n               });\r\n        });\r\n        $('ul.notifications-list .notification:not(.seen)').on('click', function(){\r\n            var thisElement = $(this);\r\n            var link = thisElement.find('a').prop('href');\r\n            var recipientId = thisElement.data('recipient');\r\n\r\n            processAjaxRequest('PATCH', '/notification/markseen', {link: link, to_userid: recipientId})\r\n                .done(function () {\r\n                    thisElement.addClass('seen');\r\n                });\r\n        });\r\n        /* End Marking seen on Notifications */\r\n\r\n        $('#form-task-confirm button[data-task-confirm]').on('click', function(){\r\n           var confirm = $(this).data('task-confirm');\r\n            var form = $('#form-task-confirm');\r\n            var method = form.find('input[name=\"_method\"]').val() || 'POST';\r\n            var url = form.prop('action');\r\n\r\n            var formData = form.serialize() + '&confirm=' + confirm;\r\n\r\n            processAjaxRequest(method, url, formData)\r\n                .done(function(data){\r\n\r\n                    showInfoMessage(data.message, '');\r\n\r\n                    setTimeout(function () {\r\n                        if (data.redirectTo != undefined) {\r\n                            window.location = data.redirectTo;\r\n                        } else {\r\n                            location.reload();\r\n                        }\r\n                    }, 1500);\r\n                });\r\n        });\r\n\r\n        $('#view-task-image-modal').on('show.bs.modal', function(e)\r\n        {\r\n            var img = $(e.relatedTarget).find('img').prop('src');\r\n            $(this).find('.modal-body img').prop('src', img);\r\n        })\r\n            .on('hidden.bs.modal', function()\r\n            {\r\n                $(this).find('.modal-body img').prop('src', '');\r\n            });\r\n\r\n\r\n        $('.btn-update-task-status').on('click', function(){\r\n            var thisElement = $(this),\r\n                status = thisElement.data('status'),\r\n                from_userid = thisElement.data('userid'),\r\n                form = thisElement.closest('form'),\r\n                loader = form.find('.loader');\r\n\r\n            var additionalParams = '&status=' + status + '&from_userid=' + from_userid;\r\n\r\n            loader.show();\r\n\r\n            processFormAjaxRequestWithData(form, additionalParams)\r\n                .done(function(data) {\r\n                    form.parent().find('.current-status-content').text(data.status);\r\n\r\n                    $(\".tooltip\").hide();\r\n\r\n                    if (status === 'done') {\r\n                        thisElement.parent().remove();\r\n                        return;\r\n                    }\r\n\r\n                    thisElement.remove();\r\n                })\r\n                .always(function(){\r\n                   loader.hide();\r\n                });\r\n        });\r\n\r\n        $('.form-task-leave-note').on('submit', function(e){\r\n            e.preventDefault();\r\n            var form = $(this);\r\n            var deferred = processFormAjaxRequest(form);\r\n            var loader = form.find('.loader');\r\n\r\n            loader.show();\r\n            form.find('.help-block').text('');\r\n            form.find('.form-group').removeClass('has-error');\r\n\r\n            deferred\r\n                .done(function(data){\r\n                    var template = $('#noteTpl').html();\r\n                    var html = Mustache.to_html(template, data.note);\r\n                    $('#list-tasknote').prepend(html);\r\n\r\n                    $('#no-notes-item').remove();\r\n\r\n                    if($('#list-tasknote li').length >= 6) {\r\n                        $('#list-tasknote li:last').remove();\r\n                    }\r\n\r\n                    resetForm(form);\r\n                })\r\n                .fail(function(data){\r\n                    var error = data.responseJSON.note[0];\r\n                    form.find('.help-block').text(error);\r\n                    form.find('.form-group').addClass('has-error');\r\n                })\r\n                .always(function(){\r\n                    loader.hide();\r\n                });\r\n        });\r\n\r\n        $('[data-tooltip-validation]').tooltip({trigger: 'manual'}).tooltip('show');\r\n\r\n        $('input.mobile_no').inputmask(\"mask\", {\"mask\": \"(+63) 999-9999999\"});\r\n\r\n        $('table.datatable').DataTable();\r\n\r\n    });\r\n","$(function(){\r\n\r\n    /* Registration Page */\r\n\r\n    $('[data-tooltip-validation]').tooltip({trigger: 'manual'}).tooltip('show');\r\n\r\n    $('input.mobile_no').inputmask(\"mask\", {\"mask\": \"(+63) 999-9999999\"});\r\n\r\n    /* Registration Page End */\r\n\r\n\r\n\r\n});\r\n"],"sourceRoot":"/source/"}